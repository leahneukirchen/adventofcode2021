d â† {â€¢BQN ("âŸ¨âŸ©"âˆ¾ğ•©) âŠËœ ("[]"âˆ¾ğ•©) âŠ ğ•©}Â¨â€¢FLines"day18"

Split â† { ğ•Š âŸ¨l,râŸ©: { ğ•Š @: { ğ•Š @: @ ; ğ•Š r2: lâ€¿r2 } Split r ;
                     ğ•Š l2: l2â€¿r } Split l ;
          ğ•Š n: n â‰¥ 10 ? (âŒŠâ‹ˆâŒˆ) nÃ·2 ;
          @ }

Addlm â† { n ğ•Š âŸ¨l,râŸ©: âŸ¨n Addlm l, râŸ© ; n ğ•Š m : n + m }
Addrm â† { n ğ•Š âŸ¨l,râŸ©: âŸ¨l, n Addrm râŸ© ; n ğ•Š m : n + m }

Explode â† {
  4 ğ•Š âŸ¨l,râŸ©: 0â€¿lâ€¿r ;
  d ğ•Š âŸ¨l,râŸ©: { ğ•Š @: { ğ•Š @: @ ;
                       ğ•Š âŸ¨r2,ln,rnâŸ©: âŸ¨ln Addrm l,r2âŸ©â€¿0â€¿rn } (d+1) Explode r ;
               ğ•Š âŸ¨l2,ln,rnâŸ©: âŸ¨l2,rn Addlm râŸ©â€¿lnâ€¿0 } (d+1) Explode l ;
  @
}

Reduce â† { ğ•Š t: { ğ•Š @: { ğ•Š @: t ; ğ•Š t3: Reduce t3 } Split t ;
                  ğ•Š t2: Reduce t2 } âŠ‘ 0 Explode t }

Add â† Reduceâˆ˜â‹ˆ

Mag â† { ğ•Š âŸ¨l,râŸ©: (3Ã—Mag l)+(2Ã—Mag r) ; ğ•Š n: n }

â€¢Show Mag AddËœÂ´ âŒ½ d
â€¢Show âŒˆÂ´â¥ŠMagâˆ˜AddâŒœËœ d
